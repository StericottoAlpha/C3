{% extends "base.html" %}

{% block content %}
<style>
  :root{
    --teal:#7fa7a5;
    --dark:#4f4f4f;
    --grid:#6e6e6e;
    --date:#7fa7a5;

    --red:#e74c3c;
    --yellow:#f1c40f;
    --green:#2ecc71;
    --blue:#3498db;
    --purple:#9b59b6;
  }

  .cal-wrap{ max-width: 1100px; margin: 18px auto; padding: 0 14px; }
  .cal-head{
    display:flex; justify-content:space-between; align-items:flex-end;
    gap: 16px; margin-bottom: 10px;
  }
  .cal-year{ font-size:72px; font-weight:800; color:var(--teal); line-height:1; }
  .cal-month{ font-size:64px; font-weight:500; color:#444; line-height:1; }
  .cal-nav{ display:flex; gap:10px; margin-top:8px; }
  .cal-nav a{
    text-decoration:none; color:#333; border:1px solid #ddd;
    padding:6px 10px; border-radius:10px; background:#fff;
  }

  .cal-table{ width:100%; border-collapse:collapse; table-layout:fixed; background:#fff; }
  .cal-table th, .cal-table td{ border:2px solid var(--grid); }
  .cal-table th{ color:#fff; padding:10px 0; font-weight:700; }
  .cal-table th.sun, .cal-table th.sat{ background:var(--teal); }
  .cal-table th.wd{ background:var(--dark); }

  .cal-table td{ height:120px; vertical-align:top; position:relative; padding:10px; }
  .cal-table td:hover{ background:#f8fafc; }

  .cal-daynum{
    position:absolute; top:8px; right:10px;
    color:var(--date); font-weight:800; font-size:14px;
  }
  .cal-sales{ margin-top:18px; font-size:22px; text-align:center; color:#333; }
  .cal-sales.muted{ color:#bbb; }

  .cal-icons{
    margin-top:10px; display:flex; justify-content:center; gap:10px; flex-wrap:wrap;
  }
  .cal-badge{
    display:inline-flex; align-items:center; gap:6px;
    font-weight:800; font-size:16px; color:#333;
  }
  .dot{
    width:22px; height:22px; border-radius:50%;
    display:inline-flex; align-items:center; justify-content:center;
    color:#fff; font-size:14px; line-height:1;
  }
  .r{ background:var(--red); }
  .y{ background:var(--yellow); color:#333; }
  .g{ background:var(--green); }
  .b{ background:var(--blue); }
  .p{ background:var(--purple); }

  .out-month{ background:#fafafa; }
  .out-month .cal-daynum{ color:#bbb; }
  .out-month .cal-sales, .out-month .cal-icons{ opacity:.25; }

  .cal-legend{
    display:flex; gap:18px; align-items:center; flex-wrap:wrap;
    margin-top:12px; font-size:22px; color:#444;
  }
  .cal-legend .item{ display:flex; align-items:center; gap:8px; }
</style>

<div class="cal-wrap">
  <div class="cal-head">
    <div>
      <div class="cal-year">{{ year }}</div>
      <div class="cal-nav">
        <a href="?year={{ prev.year }}&month={{ prev.month }}">‚Üê Prev</a>
        <a href="?year={{ next.year }}&month={{ next.month }}">Next ‚Üí</a>
      </div>
    </div>
    <div class="cal-month">{{ month_name }}</div>
  </div>

  <table class="cal-table">
    <thead>
      <tr>
        <th class="sun">Sunday</th>
        <th class="wd">Monday</th>
        <th class="wd">Tuesday</th>
        <th class="wd">Wednesday</th>
        <th class="wd">Thursday</th>
        <th class="wd">Friday</th>
        <th class="sat">Saturday</th>
      </tr>
    </thead>

    <tbody>
      {% for week in calendar_grid %}
        <tr>
          {% for cell in week %}
            <td class="{% if not cell.in_month %}out-month{% endif %}">
              <div class="cal-daynum">{{ cell.date|date:"j" }}</div>

              {% if cell.sales_yen %}
                <div class="cal-sales">¬•{{ cell.sales_yen }}</div>
              {% else %}
                <div class="cal-sales muted">&nbsp;</div>
              {% endif %}

              <div class="cal-icons">
                {% if cell.claim %}
                  <span class="cal-badge"><span class="dot r">!</span>{{ cell.claim }}</span>
                {% endif %}
                {% if cell.trouble %}
                  <span class="cal-badge"><span class="dot y">!</span>{{ cell.trouble }}</span>
                {% endif %}
                {% if cell.praise %}
                  <span class="cal-badge"><span class="dot g">!</span>{{ cell.praise }}</span>
                {% endif %}
                {% if cell.report %}
                  <span class="cal-badge"><span class="dot b">üí¨</span>{{ cell.report }}</span>
                {% endif %}
                {% if cell.other %}
                  <span class="cal-badge"><span class="dot p">‚Ä¶</span>{{ cell.other }}</span>
                {% endif %}
              </div>
            </td>
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="cal-legend">
    <div class="item"><span class="dot r">!</span>„ÇØ„É¨„Éº„É†</div>
    <div class="item"><span class="dot y">!</span>ÊïÖÈöú</div>
    <div class="item"><span class="dot g">!</span>Ë≥ûË≥õ</div>
    <div class="item"><span class="dot b">üí¨</span>Â†±Âëä</div>
    <div class="item"><span class="dot p">‚Ä¶</span>„Åù„ÅÆ‰ªñ</div>
  </div>
</div>
{% endblock %}
