{% extends "base.html" %}

{% block title %}{{ report.title }} - C3{% endblock %}

{% block content %}

<!-- ✅ 背景（ホーム風：単色・グラデ無し） -->
<div aria-hidden="true"
     class="fixed inset-0 -z-10 overflow-hidden pointer-events-none"
     style="background:#c8d8d6;">
</div>

<div class="min-h-screen py-6 px-4 sm:px-6 pb-28">
  <div class="max-w-4xl mx-auto">

    <!-- 外枠フレーム -->
    <div class="rounded-3xl border border-gray-200 bg-white/75 backdrop-blur-[1px] shadow-sm p-5 sm:p-6">

      <!-- Header -->
      <div class="flex items-start justify-between gap-3 mb-5">
        <div class="flex items-center gap-3">
          <a href="{% url 'reports:list' %}"
             class="inline-flex items-center justify-center h-10 w-10 rounded-xl border border-gray-200 bg-white
                    text-gray-700 hover:bg-gray-50 transition"
             aria-label="日報一覧に戻る">
            <span class="text-xl leading-none">←</span>
          </a>

          <div>
            <p class="text-xs text-gray-500">日報詳細</p>
            <h1 class="text-lg sm:text-xl font-extrabold text-gray-900">詳細</h1>
          </div>
        </div>

        {% if report.date %}
          <div class="text-right">
            <div class="text-xs text-gray-500">日付</div>
            <div class="text-sm font-bold text-gray-900">{{ report.date|date:"Y/m/d" }}</div>
          </div>
        {% endif %}
      </div>

      <!-- Main Card -->
      <div class="rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden">

        <!-- Title area -->
        <div class="p-5 sm:p-6 border-b border-gray-100">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div class="min-w-0">
              <h2 class="text-xl sm:text-2xl font-extrabold text-gray-900 break-words">
                {{ report.title|default:"（タイトル未設定）" }}
              </h2>

              <div class="mt-2 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-gray-600">
                <span class="inline-flex items-center gap-2">
                  <span class="text-gray-400">作成</span>
                  <span class="font-semibold text-gray-800">{{ report.created_at|date:"H:i" }}</span>
                </span>

                {% if report.user %}
                  <span class="inline-flex items-center gap-2">
                    <span class="text-gray-400">投稿者</span>
                    <span class="font-semibold text-gray-800">
                      {{ report.user.user_id|default:report.user }}
                      {% if report.user.get_user_type_display %}
                        <span class="text-gray-500">（{{ report.user.get_user_type_display }}）</span>
                      {% endif %}
                    </span>
                  </span>
                {% endif %}

                {% if report.store and report.store.store_name %}
                  <span class="inline-flex items-center gap-2">
                    <span class="text-gray-400">店舗</span>
                    <span class="font-semibold text-gray-800">{{ report.store.store_name }}</span>
                  </span>
                {% endif %}
              </div>
            </div>

            <!-- Badges -->
            <div class="flex flex-wrap items-center gap-2">
              {% if report.genre %}
                <span class="inline-flex items-center rounded-full px-3 py-1 text-xs font-bold ring-1
                  {% if report.genre == 'claim' %}bg-red-50 text-red-700 ring-red-200
                  {% elif report.genre == 'praise' %}bg-emerald-50 text-emerald-700 ring-emerald-200
                  {% elif report.genre == 'accident' %}bg-amber-50 text-amber-700 ring-amber-200
                  {% elif report.genre == 'report' %}bg-sky-50 text-sky-700 ring-sky-200
                  {% else %}bg-gray-100 text-gray-700 ring-gray-200{% endif %}">
                  {{ report.get_genre_display }}
                </span>
              {% endif %}

              {% if report.location %}
                <span class="inline-flex items-center rounded-full bg-gray-100 text-gray-700 ring-1 ring-gray-200 px-3 py-1 text-xs font-bold">
                  {{ report.get_location_display }}
                </span>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Content -->
        <div class="p-5 sm:p-6">
          <div class="rounded-2xl border border-gray-200 bg-gray-50 p-4 sm:p-5">
            <div class="text-sm font-bold text-gray-600 mb-2">内容</div>
            <p class="text-sm text-gray-900 whitespace-pre-wrap break-words">
              {{ report.content|default:"（本文なし）" }}
            </p>
          </div>

          <!-- Images -->
          {% if report.images.all %}
            <div class="mt-6">
              <div class="text-sm font-bold text-gray-600 mb-2">画像</div>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                {% for image in report.images.all %}
                  <a href="{{ image.file_path.url }}" class="block rounded-2xl border border-gray-200 overflow-hidden bg-white hover:shadow-sm transition">
                    <img src="{{ image.file_path.url }}" alt="Report Image" class="w-full h-auto">
                  </a>
                {% endfor %}
              </div>
            </div>
          {% endif %}

          <!-- BBS -->
          <div class="mt-6 rounded-2xl border border-gray-200 bg-white p-4">
            <div class="flex items-center justify-between gap-3">
              <div>
                <div class="text-sm font-bold text-gray-900">掲示板連携</div>
                <div class="text-xs text-gray-500 mt-0.5">この日報が掲示板へ連携されているか</div>
              </div>

              {% if report.post_to_bbs %}
                <span class="inline-flex items-center gap-2 rounded-full bg-teal-100 text-teal-700 px-3 py-1 text-xs font-bold">
                  <span class="h-2 w-2 rounded-full bg-teal-600"></span>
                  連携あり
                </span>
              {% else %}
                <span class="inline-flex items-center gap-2 rounded-full bg-gray-100 text-gray-600 px-3 py-1 text-xs font-bold">
                  <span class="h-2 w-2 rounded-full bg-gray-400"></span>
                  連携なし
                </span>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Footer -->
        <div class="px-5 sm:px-6 py-4 bg-gray-50 border-t border-gray-200">
          <div class="flex flex-wrap items-center justify-between gap-2 text-xs text-gray-500">
            <span>Report ID: {{ report.report_id }}</span>
            <span>Created: {{ report.created_at|date:"Y-m-d H:i:s" }}</span>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

{% endblock %}

